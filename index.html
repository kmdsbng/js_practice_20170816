<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title></title>
</head>
<body>
  <p id="namespace"></p>
  <p id="greetspace"></p>

  <script tyoe="text/javascript">

    class Name {
      constructor(value) {
        this.value = value;
      }

      nameWithPostfix() {
        return this.value + 'と申します。';
      }

      length() {
        return this.nameWithPostfix().length
      }

      startOf(len) {
        return this.nameWithPostfix().substr(0, len);
      }
    }

    class NameRenderer {
      constructor(node, name) {
        this.node = node;
        this.name = name;
      }

      showStartOf(length) {
        this.node.textContent = this.name.startOf(length);
      }
    }

    class GreetRenderer {
      constructor(node) {
        this.node = node;
      }

      initialize() {
        this.node.style.webkitTransitionDuration = '3s';
        this.node.style.opacity = 0;
        this.node.textContent = 'どうぞよろしくお願い申し上げます。'
      }

      showWithAnimation() {
        this.node.style.opacity = 1;
      }
    }

    class NameCount {
      constructor() {
        this.count = 0;
      }

      increment() {
        this.count += 1;
      }

      getCount() {
        return this.count;
      }
    }

    var myName = new Name('半沢直樹');
    var nameSpaceElement = document.getElementById('namespace');
    var greetSpaceElement = document.getElementById('greetspace');
    var nameRenderer = new NameRenderer(nameSpaceElement, myName);
    var greetRenderer = new GreetRenderer(greetSpaceElement);
    var nameCount = new NameCount();

    greetRenderer.initialize();

    function showNameIteratable() {
      nameCount.increment();
      if (myName.length() > nameCount.getCount()) {
        nameRenderer.showStartOf(nameCount.getCount());
      } else {
        clearInterval(setltv);
        greetRenderer.showWithAnimation();
      }
    }

    var setltv = setInterval(showNameIteratable, 500);
  </script>

</body>
</html>


